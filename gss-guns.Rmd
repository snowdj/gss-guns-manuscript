---
anonymous: no
output: 
#  word_document:
#    reference_docx: ~/Dropbox/miscelanea/svm-r-markdown-templates/svm-rmarkdown-word.docx
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: ~/Dropbox/miscelanea/svm-r-markdown-templates/svm-latex-ms.tex
bibliography: ~/Dropbox/master.bib
biblio-style: apsr
geometry: margin=1in
header-includes:
   - \linespread{1.05}
title: "What Americans Really Think About Gun Control: Evidence from the General Social Survey, 1972-2016"
# subtitle: 
thanks: "Replication files are available on the author's Github account ([github.com/svmiller](https://github.com/svmiller)). **Corresponding author**: svmille@clemson.edu."
author:
- name: Steven V. Miller
  affiliation: Clemson University
  email: svmille@clemson.edu
date: "`r format(Sys.time(), '%B %d, %Y')`"
abstract: "Gun control is one of the most controversial public opinion debates in the United States with each new mass shooting raises the stakes involved in the debate. It is easy to assume gridlock that has blocked legislation on gun control follows because of the mass-level polarization on the topic of gun control. My analysis of 28 waves of General Social Survey data from 1972 to 2016 shows this is wrong. My analysis of the data generates four key findings: 1) GOP partisanship does not robustly reduce support for gun control; 2) most 'strong' Republicans actually support gun control; 3) polarization of attitudes about gun control is only partial and recent; and 4) our casual assumptions about regional variation in attitudes toward gun control need re-evaluation. I conclude with a discussion of the differences we observe between elite polarization and mass polarization and with implications for the future of gun control advocacy."
fontfamily: mathpazo
fontfamilyoptions: sc, osf
fontsize: 11pt
keywords: "gun control, political attitudes, public opinion, polarization, elite cues"
---

```{r loadpackages, include=FALSE, cache=FALSE}
knitr::opts_chunk$set(cache=TRUE)
setwd("~/Dropbox/projects/gss-guns")

library(arm)
library(broom)

library(stargazer)
# library(plyr)
library(knitr)
library(xtable)
library(foreign)
library(car)
library(dotwhisker)
library(tidyverse)
library(forcats)
library(stevemisc)
library(merTools)

rd <- function(val) { sub("^(-?)0.", "\\1.", sprintf("%.3f", val)) }



nlopt <- function(par, fn, lower, upper, control) {
    .nloptr <<- res <- nloptr(par, fn, lb = lower, ub = upper, 
        opts = list(algorithm = "NLOPT_LN_BOBYQA", print_level = 1,
        maxeval = 1000, xtol_abs = 1e-6, ftol_abs = 1e-6))
    list(par = res$solution,
         fval = res$objective,
         conv = if (res$status > 0) 0 else res$status,
         message = res$message
    )
}
library(nloptr)
library(boot)
# library(optimx)
# library(texreg)

# library(stringr)


get_sims <- function(model, newdata, nsim, seed){
  require(arm)
  set.seed(seed)
    arguments <- as.list(match.call())
  modelsim <- arm::sim(model, n.sims=nsim)
  mm.dat = model.matrix(terms(model),newdata)
  outputfull<-NULL
  for(i in (1:nsim)) {
    output <- NULL
    yi <- mm.dat %*% coef(modelsim)$fixef[i,]
    sim<-rep(i, length (yi))
    output<-cbind(yi, sim)
    outputfull<-rbind (outputfull, output)
  }
    outputfull<-as.data.frame (outputfull)
names (outputfull)<-c("y", "sim")
  return(outputfull)

}

make_qi_row <- function(sims, var, lab, logit=TRUE) {
  require(boot)
  if(logit) {
  a <- mean(inv.logit(sims[var == min(var), 1]))
  b <- mean(inv.logit(sims[var == max(var), 1]))
  c <- mean(inv.logit(sims[var == max(var), 1])) - mean(inv.logit(sims[var == min(var), 1]))
 diffs <- inv.logit(sims[var == max(var), 1]) - inv.logit(sims[var == min(var), 1])
  d <- sd(inv.logit(sims[var == max(var), 1])) - mean(inv.logit(sims[var == min(var), 1]))
  e <- paste("(",sprintf("%.3f", round(quantile(diffs,0.05), 3)),
             ",",
                 sprintf("%.3f", round(quantile(diffs,0.95), 3)),
             ")", sep="")
  }
  else {
  a <- mean(sims[var == min(var), 1])
  b <- mean(sims[var == max(var), 1])
  c <- mean(sims[var == max(var), 1]) - mean(sims[var == min(var), 1])
  diffs <- sims[var == max(var), 1] - sims[var == min(var), 1]

  e <- paste("(",sprintf("%.3f", round(quantile(diffs,0.05), 3)),
             ",",
                 sprintf("%.3f", round(quantile(diffs,0.95), 3)),
             ")", sep="")
  }

  
  result <- data.frame(label=lab, x0=a, x1= b, fd=c, ci=e)
  return(result)
  
}

```

```{r loaddata, include=FALSE}
# knitr::opts_chunk$set(cache=TRUE) 
GSS7216 <- haven::read_dta("~/Dropbox/data/gss/GSS7216_R1a.dta")

GSS7216 %>%
  select(region, gun, gunlaw, gunimp, guninfo, gunfirm, owngun, rowngun, gun12, gunsales, gunsdrug, semiguns, guns911, othguns, shotgun, hgunlaw, hguncrim, crimup, crimdown, gunage, gunsdrnk, pistol, rifle, age, educ, degree, race, rincome, rincom06, partyid, sex, ethnic, year) %>%
  mutate(regioncondensed = NA,
         regioncondensed = ifelse(region == 8 | region == 9, "West", regioncondensed),
         regioncondensed = ifelse(region == 3 | region == 4, "Midwest", regioncondensed),
         regioncondensed = ifelse(region == 5 | region == 6 | region == 7, "South", regioncondensed),
         regioncondensed = ifelse(region == 1 | region == 2, "Northeast", regioncondensed),
         gun = car::recode(gun, "1=1; 2=0"),
         gunlaw = car::recode(gunlaw, "1=1; 2=0"),
         gunmostimp = car::recode(gunimp, "1=1; 2:4=0"),
         gunimpd = car::recode(gunimp, "1:2=1; 3:4=0"),
         # Flip the scale; create naturally occurring zero (i.e. the not important at all).
         gunimp = car::recode(gunimp, "1=3; 2=2; 3=1; 4=0"),
         guninfod = car::recode(guninfo, "1:2=1; 3:4=0"),
         # The unlikely to changes are 1
         gunfirmd = car::recode(gunfirm, "1:2=0; 3:4=1"),
         owngund = car::recode(owngun, "1=1; 2=0; 3=NA"),
         learnguninternet = car::recode(gun12, "1=1; 2=0"),
         gunsales = car::recode(gunsales, "1=5; 2=4; 3=3; 4=2; 5=1"),
         gunsalesd = car::recode(gunsales, "4:5=1;1:3=0"),
         gunsdrug = car::recode(gunsdrug, "1=1; 2=-1; 3=0"),
         gunsdrugd = car::recode(gunsdrug, "1=1; -1=0; 0=0"),
         semiguns = car::recode(semiguns, "1=0; 2=1"),
         guns911 = car::recode(guns911, "1=1; 2=0"),
         # Would support state laws making it illegal to carry a firearm while drunk.
         gunsdrnk = car::recode(gunsdrnk, "1=1;2=0"),
         hgunlaw = car::recode(hgunlaw, "1=1; 2=0"),
         hguncrim = car::recode(hguncrim, "1=1; 2=-1; 3=0"),
         crimup = car::recode(crimup, "1=1; 2=0"),
         crimdown = car::recode(crimdown, "1=1; 2=0")
         ) -> GSS

rm(GSS7216)

GSS %<>%
  group_by(year) %>%
  mutate(z_educ = arm::rescale(educ),
         z_rincome = arm::rescale(rincome),
         z_rincom06 = arm::rescale(rincom06)) %>%
  ungroup() %>%
  mutate(z_age = arm::rescale(age),
         collegeed = car::recode(degree, "0:2=0; 3:4=1"),
         hsed = car::recode(degree, "0=0; 1:4=1"),
         graded = car::recode(degree, "0:3=0; 4=1"),
         white = car::recode(race, "1=1; 2:3=0"),
         black = car::recode(race, "1=0; 2=1; 3=0"),
         otherrace = car::recode(race, "1:2=0; 3=1"),
         partyid = car::recode(partyid, "7=NA"),
         z_partyid = arm::rescale(partyid),
         female = car::recode(sex, "1=0; 2=1"),
         hispanic = ifelse(ethnic == 17 | ethnic == 22 | 
                             ethnic == 25 | ethnic == 32 | 
                             ethnic == 38, 1, 0))

write_csv(GSS, "gss-guns-data.csv")
```

# Introduction

Gun control is one of the most controversial public policy issues in the United States. Its salience has only increased after recent domestic terror incidents in places like the Pulse night club and the Inland Regional Center in San Bernardino. The San Bernadino incident in particular led to a strong reaction from some leading newspapers trying to push this debate into legislative action. The *New York Daily News* ran a front-page cover that engaged in deliberate issue linkage of the San Bernardino incident with other semi-automatic rampages in Aurora, Colorado Springs, and Newtown, labeling all as "terrorists" [@nydn2015ht]. The *New York Times* even dusted off a device it had not used in 95 years---the front-page editorial---to argue that legislative unwillingness to push sensible gun control legislation into law is a "moral outrage and national disgrace" [@nyt2015egea]. Successive incidents since, prominently the October 2017 mass shooting in Las Vegas that now ranks as the deadliest individual act of mass murder in U.S. history, only raise more questions about our gun laws and the salience of this controversial public policy debate. The demonstrations by the *New York Daily News* and *New York Times* still resonate among gun control advocates in light of more current events.

<!-- , most recently the Fort Lauderdale-Hollywood International Airport shooting in January 2017, In this most recent case, a shooter, who had previously drawn the suspicion of his local FBI field office  [@sholchetalmasy2017flas], exploited a checked baggage loophole that allowed him to check a hand gun for the cause of a rampage in what is otherwise one of the most secure locations in the United States (i.e. a commercial aiport). -->

The *New York Daily News* and *New York Times* made these demonstrations because gun control legislation is a non-starter in Congress. The day after the San Bernardino incident, Senate Republicans voted down legislation that would have closed background check loopholes and banned subjects on the terror watch list from purchasing firearms [@joseph2015srvd]. Republican opposition was almost unanimous, which conforms to the preferences of the National Rifle Association (NRA) on this issue. The implication here is Republican opposition to any gun control legislation follows the direct preferences of its core interest groups and its constituents. In a heavily polarized political climate, gun control legislation is a non-starter as long as Republicans control Congress or are in a position to filibuster gun control legislation. This speaks well to political science scholarship that says public opinion [e.g. @pageshapiro1983epop], especially on salient issues [@burstein2003ipo], drives public policy in the United States.

My analysis of a 44-year span of General Social Survey data tells a mixed story of the conventional wisdom that Republican leaders block gun control legislation because Republican voters are against it. I find that Republican partisanship does not robustly reduce support for gun control and that most Republicans actually support gun control. Gun control is not necessarily a partisan issue over time even if it has quickly become one. I also find that the American West, not the South, is where support for gun control is the lowest. I conclude that there is still substantial support for even meaningful gun control legislation and that a lot of conventional wisdom about gun control merits re-evaluation.

# Methods

I use General Social Survey (GSS) data for all available years from 1972 to 2016. The primary question of interest---whether the respondent favors or opposes a law that would require a person to obtain a police permit before he or she could buy a gun---is the most ubiquitous gun control item in the GSS. Its utility for the sake of this analysis is multiple. One, it appears in 28 of the 31 available GSS waves from 1972 to 2016.[^notasked] Other gun control items that appear in GSS are one-time questions. Two, the substance of the gun control question that GSS asks is subtly aggressive. It prompts the respondent to ask whether state approval for a gun of any kind is necessary when gun control opponents tend to cite precisely this kind of state overreach as justification for a maximalist interpretation of the Second Amendment to the U.S. Constitution. Thus, gun control advocates and interested lawmakers in Washington almost never express a gun control proposal like this, instead preferring to massage objections from gun control opponents with policies that target gun show loopholes, terror watch lists, or military-style rifles like the AR-15. GSS respondents that favor this form of gun control are signaling their willingness to accept other aggressive gun control measures. I keep the binary nature of this variable where a 1 indicates support of this form of gun control.

[^notasked]: The question was not asked in 1978, 1983, or 1986.

I also select data from the 2006 wave that features more granular questions about gun control policies. These include background checks for private sales, tougher penalties for illegal gun sales than drug sales, limiting semi-automatic weapons the police and military, making it illegal to carry a gun while drunk, and support for tougher gun control legislation as a function of the 9/11 terrorist attacks. These are binary variables that assume a value of 1 for respondents that favor a more aggressive gun control proposal.

The primary independent variable of interest is partisanship. This is the familiar seven-point partisanship question that ranges from "strong Democrat" to "strong Republican." I also include variables for age, sex (female), whether the respondent has a college education, fixed effects for race (leaving whites as the baseline), and whether the respondent has a gun in the household.

All dependent variables are binary, making the use of a logistic regression appropriate. However, there is important spatial and temporal heterogeneity across the 28 waves of GSS data that I use in my analysis. I account for this with mixed effects models with random effects for the condensed Census region in which the respondent resides and, for the primary dependent variable, the year of the survey. I allow the effect of partisanship to vary by region and condensed Census region. I also scale all non-binary independent variables by two standard deviations to ensure rough comparability of coefficients [@gelman2008sri].

# Results

My analyses of 28 waves of GSS data over 44 years suggest four interesting findings about public opinion and the gun control debate. First, partisanship with the Republican party does not robustly reduce support for gun control. Second, most Republicans actually support gun control, even in the current polarized political climate. Third, gun control is not necessarily a partisan issue but it is quickly becoming one. Finally, simple assumptions about regional variation mask important and more intriguing variation on attitudes toward gun control in the data.

## Partisanship Does Not Robustly Reduce Support for Gun Control

Partisanship might be our go-to explanation for individual-level support for gun control. The implication is increasing identification with the Republican Party decreases support for gun control given the many cues Republican elites send to their voters about gun control [c.f. @zaller1992nomo]. However, the partisanship-gun control relationship is not nearly as robust at the individual-level as we infer it to be at the elite-level.

```{r models1, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="asis", warning=F}
M1 <- glmer(gunlaw ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund +
              (1 + z_partyid | year) + (1 + z_partyid | regioncondensed), 
            data=subset(GSS), family=binomial(link="logit"), 
            glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))

M2 <- glmer(gunsalesd ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + 
              (1 + z_partyid | regioncondensed), data=GSS, family=binomial(link="logit"), 
            glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))

M3 <- glmer(gunsdrugd ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + 
              (1 + z_partyid | regioncondensed), data=GSS, family=binomial(link="logit"), 
            glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))

M4 <- glmer(semiguns ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + 
              (1 + z_partyid | regioncondensed), data=GSS, family=binomial(link="logit"), 
            glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))

M5 <- glmer(gunsdrnk ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + 
              (1 + z_partyid | regioncondensed), data=GSS, family=binomial(link="logit"), 
            glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))

M6 <- glmer(guns911 ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + 
              (1 + z_partyid | regioncondensed), data=GSS, family=binomial(link="logit"), 
            glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000))) 
```



```{r table1, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", message=F, warning=F}
require(stargazer)
Table1 <- capture.output(stargazer(M1, M2, M3, M4, M5, M6, type="latex", style = "ajps",
                                   title="Mixed Effects Models of Attitudes toward Gun Control",
                                   header=FALSE, font.size="small",
                                   covariate.labels=c("Age", "College Educated", "Female", "Black", 
                                                      "Other Race (Not White)", "Party ID (D to R)", "Gun in the Household"),
                                   #dep.var.labels=c("Require Police Permit?", "Background Check for Private Sales?", 
                                  #                  "Tougher Penalties than Selling Drugs?", 
                                   #                 "Limit Semi-Automatics to Police/Military?",
                                  #                  "Illegal to Carry a Gun while Drunk?", 
                                  #                  "Tougher Gun Control Laws after 9/11?"), 
                                   dep.var.labels.include = FALSE, 
                                  star.cutoffs = c(.05), digit.separator=",",
                                   model.names=FALSE, omit.stat=c("aic","ll","bic"), omit=("Constant"),
                                  notes=c("\\scriptsize \\emph{Random effect parameters (i.e. slope and intercept standard deviations) omitted for presentation.}")#,
                                          #"\\footnotesize \\emph{varies across all random effects for all models. I omit the random effect parameters (i.e. slope and intercept standard deviations)}",
                                          #"\\footnotesize \\emph{for simple presentation.}")
))

Table1[26] <- "\\multicolumn{7}{l}{\\scriptsize $^{*}$p $<$ .05} \\\\ "

Table1 <- c(Table1[a <- 1:23], "\\hline ", Table1[-a])


modelnames <- c("\\\\[-1.8ex] & \\emph{} & \\emph{Background} & \\emph{Tougher} &
                \\emph{} & \\emph{ } & \\emph{Tougher} \\\\",
"\\\\[-1.8ex] & \\emph{Require} & \\emph{Check for} & \\emph{ Penalties} &
                \\emph{Limit} & \\emph{Illegal to} & \\emph{Gun} \\\\",
                "\\\\[-1.8ex] & \\emph{Police} & \\emph{Private} & \\emph{than} &
                \\emph{Semi-} & \\emph{Carry Gun} & \\emph{Control} \\\\",
                "\\\\[-1.8ex] & \\emph{Permit} & \\emph{Sales} & \\emph{Drugs} &
                \\emph{Automatics} & \\emph{While Drunk} & \\emph{After 9/11} \\\\")

Table1 <- c(Table1[a <- 1:7], modelnames, Table1[-a])


# "\\\\[-1.8ex] & \\textbf{Model 1} & \\textbf{Model 2} & \\textbf{Model 3} & \\textbf{Model 4} & \\textbf{Model 5} & \\textbf{Model 6}\\\\ "

#for(i in c(34:43)){
#  Table2[i] <-gsub("[*]", "\\\\dagger", Table2[i])
#}
cat(Table1, sep = "\n", file = "tab-reg.txt")

cat(Table1, sep='\n') 

```

```{r dwplot, eval=F, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="hide", warning=F, fig.cap="Support for Gun Control among Partisans Over Time (GSS, 1972-2016)", fig.width=11, fig.height = 9}


m1df <- tidy(M1) %>% filter(group == "fixed") %>% mutate(model = "Require Police Permits?")
m2df <- tidy(M2) %>% filter(group == "fixed") %>% mutate(model = "Background Check for Private Sales?")
m3df <- tidy(M3) %>% filter(group == "fixed") %>% mutate(model = "Tougher Penalties than Drugs?")
m4df <- tidy(M4) %>% filter(group == "fixed") %>% mutate(model = "Limit Semi-Automatics to Military?") 
m5df <- tidy(M5) %>% filter(group == "fixed") %>% mutate(model = "Illegal to Carry Guns While Drunk?")
m6df <- tidy(M6) %>% filter(group == "fixed") %>% mutate(model = "Tougher Gun Control After 9/11?")

bind_rows(m1df, m2df, m3df, m4df, m5df, m6df) %>%
  relabel_predictors(c(z_age = "Age",                      # relabel predictors
                     collegeed = "College Educated",
                     female = "Female",
                     black = "Respondent is Black",
                     otherrace = "Respondent is Other Race (Not White)",
                     z_partyid = "Party ID (D to R)",
                     owngund = "Gun Owner")) %>%
  dwplot(.,dot_args = list(aes(colour = model, shape = model), size = 2)) + theme_steve() +
  geom_vline(xintercept = 0, linetype = 2) +
  theme(legend.position = "bottom") +
  labs(caption="Data: General Social Survey, 1972-2016. Random effect parameters (i.e. slope and intercept standard deviations) omitted for presentation.",
       title="Partisanship Does Not Have a Robust Effect on Attitudes Toward Gun Control",
       subtitle = "Increasing partisanship with the GOP only decreases support of requiring a police permit and increasing gun control as a function of 9/11.")
```

Table 1 summarizes the results from six mixed effects regression models on the dependent variables I coded from the GSS data. Increasing partisanship with the Republican Party does not have robust effects across all six models. Increasing GOP partisanship reduces support for a law that would require a police permit to own a gun and reduces support for tougher gun control laws when gun control is deliberately linked to terror threats after 9/11. However, increasing Republican partisanship does not have a discernible effect on attitudes toward background checks for private sales, tougher penalties for illegal gun purchases than illegal drug sales, limiting semi-automatics to the police and military, and for making it illegal to carry a gun while drunk.

Republican partisanship might be the easiest way of thinking about opposition to gun control legislation in the United States but GSS data suggest the effect of Republican partisanship on attitudes toward gun control measures is not robust across multiple forms of gun control policies.

## Most Republicans Actually Support Gun Control

Perhaps the most counterintuitive finding from survey data on attitudes toward gun control is that Republicans generally favor gun control legislation. This is not an anomaly unique to a specific year, nor necessarily a recent trend. There is not a year in the 28 waves of GSS data in which support among *strong* Republicans for a law that would require a police permit for a gun purchase is below 50%.

```{r ts1, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=FALSE, results="asis", warning=F, fig.cap="Support for Gun Control among Partisans Over Time", fig.width=9.5, fig.height = 5}

GSS %>%
  group_by(partyid, year) %>%
  summarize(gunlaw = round(mean(gunlaw, na.rm=T)*100, 2)) %>%
  na.omit() %>%
  ungroup() %>%
    filter(partyid == 0 | partyid == 3 | partyid == 6) %>%
  mutate(partyid = factor(partyid),
         partyid = fct_recode(partyid,
                              "Strong Democrat" = "0",
                              "Independent" = "3",
                              "Strong Republican" = "6"),
         partyid = fct_relevel(partyid,
                               "Strong Republican","Independent","Strong Democrat" )) %>%
  rename(`Party ID` = partyid) %>%
  ggplot(.,aes(x=year,y=gunlaw,colour=`Party ID`)) +
  geom_line(aes(linetype=`Party ID`)) + geom_point() + theme_steve() +
  geom_text(aes(label=ifelse(year>2015, gunlaw, '')),hjust=0, vjust=-1, fontface=1) +
  scale_y_continuous(limits = c(0, 100), name="Percent Support for \n Police Permit Before Owning a Gun", 
                     breaks=seq(0,100, 10)) + 
  scale_x_continuous(breaks=seq(1972, 2016, 4), name="Year", limits=c(1972, 2016)) +
  geom_hline(yintercept=50, linetype="dashed") + 
#  scale_colour_grey(start=0.6, end=0.2, labels=c("Strong Democrat", "Independent", "Strong Republican"), name="Party ID") +
  scale_linetype(labels=c("Strong Republican", "Independent", "Strong Democrat"), name="Party ID") +
  scale_colour_manual(values=c("#F8766D", "#00BA38", "#619cff"), labels=c("Strong Republican", "Independent", "Strong Democrat"), name="Party ID") + 
  theme(legend.position="bottom") +
  labs(caption = "Data: General Social Survey (1972-2016)",
       title = "Most Republicans Actually Support Gun Control",
       subtitle = "There is not a year in the GSS in which support for requiring police permits among the strong Republicans is below 50%")


```

Figure 1 is a time-series line chart of the percentage of responses that favor a law requiring a police permit before a person could buy a gun by partisan identification over the 27 waves from 1972 to 2016 in which that item appears. For clarity, I subset the line chart to just the strong Democrats, the independents who do not lean toward either party, and the strong Republicans. The line chart shows that the lowest support for this form of gun control came in 2012, in which 54.62% of strong Republicans favored this form of gun control. Support among the strong Republicans actually increased almost five percentage points to 59.54% in the two years after the 2012 survey, though fell again to 50.5% in 2016.

Figure 1 does show some other interesting trends over the years. Strong Democrats have become only a little more supportive of gun control over time. 75.16% of strong Democrats favored this gun control measure in 1972, which increased to 83.44% in 2016. Independents who do not lean toward one party have not changed over time. In 1972, support for this form of gun control was 69.23% among those independents, relative to 70.57% in 2016. Interestingly, strong Republicans tracked quite closely with strong Democrats before 1994. The year of the "Republican Revolution", in which the GOP took both chambers of Congress for the first time since 1953, saw support for this form of gun control fall from 82.4% in 1993 to 67.77% in 1994.


```{r sims, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="asis", message=F, warning=F}

# female, no gun

newdata <- with(GSS, 
                data.frame(gunlaw=0, z_age=0, collegeed=median(collegeed,na.rm=TRUE), female=1,
                           black=0, otherrace=0, z_partyid=max(z_partyid, na.rm=TRUE), owngund=0,
                           year=0, regioncondensed=0)
                )

M1sims <- get_sims(M1, newdata,  1000, 8675309)

fng <- with(M1sims, data.frame(lab="Female, Doesn't Own Gun", 
                  ev=rd(mean(inv.logit(y))),
                  ci=e <- paste("(", rd(quantile(inv.logit(y),0.025)),
             ", ",
                 rd(quantile(inv.logit(y),0.975)),
             ")", sep="")))

# male, doesn't own gun

newdata <- with(GSS, 
                data.frame(gunlaw=0, z_age=0, collegeed=median(collegeed,na.rm=TRUE), female=0,
                           black=0, otherrace=0, z_partyid=max(z_partyid, na.rm=TRUE), owngund=0,
                           year=0, regioncondensed=0)
                )

M1sims <- get_sims(M1, newdata,  1000, 8675309)

mng <- with(M1sims, data.frame(lab="Male, Doesn't Own Gun", 
                  ev=rd(mean(inv.logit(y))),
                  ci=e <- paste("(", rd(quantile(inv.logit(y),0.025)),
             ", ",
                 rd(quantile(inv.logit(y),0.975)),
             ")", sep="")))

# female, gun owner

newdata <- with(GSS, 
                data.frame(gunlaw=0, z_age=0, collegeed=median(collegeed,na.rm=TRUE), female=1,
                           black=0, otherrace=0, z_partyid=max(z_partyid, na.rm=TRUE), owngund=1,
                           year=0, regioncondensed=0)
                )

M1sims <- get_sims(M1, newdata,  1000, 8675309)

fog <- with(M1sims, data.frame(lab="Female, Gun Owner", 
                  ev=rd(mean(inv.logit(y))),
                  ci=e <- paste("(", rd(quantile(inv.logit(y),0.025)),
             ", ",
                 rd(quantile(inv.logit(y),0.975)),
             ")", sep="")))

# male, gun owner 

newdata <- with(GSS, 
                data.frame(gunlaw=0, z_age=0, collegeed=median(collegeed,na.rm=TRUE), female=0,
                           black=0, otherrace=0, z_partyid=max(z_partyid, na.rm=TRUE), owngund=1,
                           year=0, regioncondensed=0)
                )

M1sims <- get_sims(M1, newdata,  1000, 8675309)

mog <- with(M1sims, data.frame(lab="Male, Gun Owner", 
                  ev=rd(mean(inv.logit(y))),
                  ci=e <- paste("(", rd(quantile(inv.logit(y),0.025)),
             ", ",
                 rd(quantile(inv.logit(y),0.975)),
             ")", sep="")))


# male, gun owner, college educated

newdata <- with(GSS, 
                data.frame(gunlaw=0, z_age=0, collegeed=1, female=0,
                           black=0, otherrace=0, z_partyid=max(z_partyid, na.rm=TRUE), owngund=1,
                           year=0, regioncondensed=0)
                )

M1sims <- get_sims(M1, newdata,  1000, 8675309)

mogc <- with(M1sims, data.frame(lab="Male, Gun Owner, College Educated", 
                  ev=rd(mean(inv.logit(y))),
                  ci=e <- paste("(", rd(quantile(inv.logit(y),0.025)),
             ", ",
                 rd(quantile(inv.logit(y),0.975)),
             ")", sep="")))

EVs <-  rbind(fng, mng, fog, mog, mogc)

#colnames(EVs) <- c("**Category**", "**Expected Value**", "**95% Interval**")
# colnames(EVs) <- c("\\textbf{Category}", "\\textbf{Expected Value}", "\\textbf{95\\% Interval}")
colnames(EVs) <- c("Category", "Expected Value", "95% Interval")
#sink('analysis-output.txt')
#kable(EVs, align=c("l","c","c"), caption="Expected Values of Support for Police Permits for Gun Purchases Among Strong Republicans")
#sink()
Tabb <- capture.output(stargazer(EVs, type="latex", header=F,
          summary=F, rownames=F, title="Expected Values of Support for Police Permits for Gun Purchases Among Strong Republicans"))
cat(Tabb, sep = "\n", file = "tab-evs.txt")
cat(Tabb, sep='\n') 
#sink()

```

Figure 1 clarifies the results from Model 1, telling us that strong Republicans are less likely to support gun control but this should not be confused as equivalent to a statement that strong Republicans are likely to "oppose" gun control. Table 2 tells a similar story with simulations of the regression from a multivariate normal distribution to generate quantities of interest. I set the explanatory variables at their typical values (i.e. white respondents around age 51 without a college education), set the party ID variable at its maximum (i.e. strong Republicans) and allow the gun ownership and gender variable to vary. The simulations show the point estimates for expected value of support for police permits for gun purchases, given the explanatory variables (e.g. women/men, strong GOP, owns gun/does not own a gun) are above .500 in every application. Further, the 95% interval for all expected values from the simulations are above .500 in all but one category: men with strong GOP affiliation, no college education, and with a gun in the home. However, one adjustment to that class of respondent---the presence of a college diploma---increases support for police permits before purchasing a gun to .592 with a 95% distribution of expected values that are above .500.

This is an important pedagogical lesson for pundits, scholars, and interested citizens who want to understand variation in public opinion about the gun control debate. Model 1 in Table 1 shows a negative relationship between increasing GOP partisanship and support for a police permit prior to owning a gun that is discernible from a zero relationship. In other words, increasing partisanship with the Republican party decreases support for this form of gun control relative to those with lesser affinity for the GOP (including strong Democrats). The reader can mostly see this story in Figure 1. However, it would be a mistake, both statistical and substantive, to assume that statement is equivalent to "increasing GOP partisanship makes a respondent oppose this form of gun control." This would not be true in this case. Strong Republicans still support this form of gun control, though strong Democrats support it more.

## Gun Control Is Not Necessarily a Partisan Issue, but It Is Becoming One

Most Republicans are on board with gun control measures. However, we are observing a growing rift between Democrats and Republicans on this issue that seems to have increased during the Obama Administration.

Figure \ref{fig:simyear} shows more simulations of the dependent variable from a draw of a multivariate normal distribution for three different values of partisanship---strong Republicans, strong Democrats, and pure independents---across all survey waves with all other explanatory variables held at their typical value. The results show partisan differences first emerging as a result of the Republican Revolution of 1994 but show increasing polarization on this issue that seems to occur almost entirely during the Obama Administration. This coincides with prominent events like the spike in gun sales after Obama's 2008 election [@bohn2008gss] and cues from the NRA that Obama was the most "anti-gun candidate ever" who will "take your guns away" [@smith2008nra]. On average, Republicans are less likely to support this gun control measure than those whose political affinities gravitate more to the Democratic Party. However, Figure \ref{fig:simyear} shows that the effect of GOP partisanship is more pronounced in recent years than it is overall. <!--The effect of GOP partisanship decreases support for gun control even more in 2016 in addition to the overall decrease in support for GOP partisanship on average. In addition, Republican movement against gun control during the Obama Administration had an overall dampening effect on the average level of support for gun control in 2012, 2014, and 2016, as seen in the random intercepts.-->

<!-- Figure 2 illustrates this by plotting the conditional variances of the random year intercept and random slopes for party identification in a caterpillar plot. The conditional variances do not have the same exact interpretation as a standard error for a fixed effect [e.g. @schall1991eglm; @gelmanhill2007dar], but the reader can think of it as a "starting point." Some years may have higher than "average" support or opposition to requiring police permits for gun purchases. In addition, the random slope for party identification allows preliminary judgments that the effect of increasing GOP partisanship may be stronger or weaker in some years than they were on average. -->

```{r simyear, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="asis", warning=F, fig.cap="\\label{fig:simyear} Support for Gun Control by Year and Partisanship", fig.width=8.5}

GSS %>%
  group_by(z_partyid, partyid, year) %>%
  summarize(z_age = 0,
            collegeed = 0,
            female = 0,
            black = 0,
            otherrace = 0,
#            z_partyid = max(z_partyid, na.rm=T),
            owngund = 0,
regioncondensed = 0)  %>%
  na.omit() %>% 
  ungroup() %>%
  filter(year != 1972 & year != 1975 & year !=1978 & year !=1983 & year != 1986) %>% 
  as.data.frame() -> newdat_m1y

m1yv <- predictInterval(M1, newdata = newdat_m1y, type="probability", level=0.80,
                        include.resid.var = F)
m1yv <- cbind(newdat_m1y, m1yv) 


m1yv %>%
  filter(partyid == 0 | partyid == 3 | partyid == 6) %>%
  mutate(partyid = factor(partyid),
         partyid = fct_recode(partyid,
                              "Strong Democrat" = "0",
                              "Independent" = "3",
                              "Strong Republican" = "6"),
         partyid = fct_relevel(partyid,
                               "Strong Republican","Independent","Strong Democrat" )) %>%
  rename(`Party ID` = partyid) %>%
  ggplot(.,aes(x=year, y=fit, ymin=lwr, ymax=upr, fill=`Party ID`)) +
  theme_steve() +
  geom_line(aes(color=`Party ID`, linetype = `Party ID`), size=1.2) +
  geom_ribbon(aes(fill = `Party ID`), alpha = I(0.2), color = I("black")) +
  scale_y_continuous(breaks = seq(.4, 1, by = .1), limits = c(.4, 1)) +
  geom_hline(yintercept = .5, linetype = "dashed") +
  scale_x_continuous(breaks=seq(1972, 2016, 2), name="Year", limits=c(1972, 2016)) + 
  ylab("Simulated Probability of Support for Requiring\na Police Permit Before Obtaining a Gun") +
  theme(legend.position='bottom') +
  labs(caption = "Data: General Social Survey (1974-2016).",
       title = "Gun Control Is Not Necessarily a Partisan Issue, but It Is Becoming One",
       subtitle = "We first observe polarization on gun control after the Republican Revolution and more recently under Obama.") 

#show_ranef(M1,"year")  + theme_steve() + facet_wrap(~variable,scale="free_x", labeller = as_labeller(c(`(Intercept)` = "Intercept", `z_partyid`="Party ID (D to R)"))) + ylab("")
```


Most Republicans actually support gun control measures and the issue at stake is not necessarily as polarizing at the individual-level as it is at the elite-level. However, it is quickly becoming a partisan issue among the electorate.

## Unintuitive Regional and Temporal Variation in Support for Gun Control

Explanations for attitudes about gun control across regions in the United States tend to make rather broad and simple statements. Southerners love guns, for whatever purpose [e.g @brennanetal1993gsgc], which we think makes Southerners more likely to elect politicians who will fight hard for their interpretation of the Second Amendment to the U.S. Constitution. Likewise, guns are prominent in the the West as well, which might make the region also more opposed to gun control in general [@wolpertgimpel1998sisp].

These statements belie interesting variation in attitudes toward gun control across regions and by partisanship. Figure \ref{fig:simgoprevol} summarizes simulations from a split of Model 1 in Table 1, subsetting the analyses of Model 1 in Table 1 to the survey waves before the "Republican Revolution" (1972-1993) and after it (1994-2016). Thereafter, I generate simulations with confidence intervals for varying levels of partisanship across the four Census regions in the model with all other explanatory variables held at their typical value. Figure \ref{fig:simgoprevol} does not suggest any meaningful variation in attitudes toward gun control as a result of the sorting of the electorate in 1994 in the Midwest or the West. Instead, we see two interesting and discrernible differences in the Northeast and the South. Republicans in the Northeast are less likely to support gun control after the Republican Revolution than Republicans in the Northeast before it. Further, we see a small but discernible difference in the South, though it involves the strong Democrats and not the strong Republicans. Strong Democrats in the South became more likely to support gun control after the Republican Revolution than strong Democrats before it.

```{r simgoprevol, eval=TRUE, echo=FALSE, tidy = TRUE, size="small", cache=TRUE, results="asis", warning=F, fig.cap="\\label{fig:simgoprevol} Support for Gun Control by Partisanship, Before and After the Republican Revolution", fig.width=11, fig.height=8}

M1a <- glmer(gunlaw ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + (1 + z_partyid | year) + (1 + z_partyid | regioncondensed), data=subset(GSS, year <= 1993), family=binomial(link="logit"), glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))

M1b <- glmer(gunlaw ~ z_age + collegeed + female + black + otherrace + z_partyid + owngund + (1 + z_partyid | year) + (1 + z_partyid | regioncondensed), data=subset(GSS, year > 1993), family=binomial(link="logit"), glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000)))


GSS %>%
  group_by(regioncondensed, z_partyid, partyid, year) %>%
  summarize(z_age = 0,
            collegeed = 0,
            female = 0,
            black = 0,
            otherrace = 0,
#            z_partyid = max(z_partyid, na.rm=T),
            owngund = 0)  %>%
  na.omit() %>% 
  ungroup() %>%
  filter(year != 1972 & year != 1975 & year !=1978 & year !=1983 & year != 1986) %>% 
  as.data.frame() -> newdat_m1r


GSS %>%
  filter(year <= 1993) %>%
  group_by(regioncondensed, z_partyid, partyid) %>%
  summarize(z_age = 0,
            collegeed = 0,
            female = 0,
            black = 0,
            otherrace = 0,
#            z_partyid = max(z_partyid, na.rm=T),
            owngund = 0,
            year = 0)  %>%
  na.omit() %>% as.data.frame() -> newdat_m1a



GSS %>%
  filter(year > 1993) %>%
  group_by(regioncondensed, z_partyid, partyid) %>%
  summarize(z_age = 0,
            collegeed = 0,
            female = 0,
            black = 0,
            otherrace = 0,
#            z_partyid = max(z_partyid, na.rm=T),
            owngund = 0,
            year = 0)  %>%
  na.omit() %>% as.data.frame() -> newdat_m1b


m1rv <- predictInterval(M1, newdata = newdat_m1r, type="probability", level=0.80,
                        include.resid.var = F)
m1rv <- cbind(newdat_m1r, m1rv) 

m1av <- predictInterval(M1a, newdata = newdat_m1a, type="probability", level=0.80,
                        include.resid.var = F)
m1av <- cbind(newdat_m1a, m1av) %>%
  mutate(Period = "Pre-Republican Revolution")

m1bv <- predictInterval(M1b, newdata = newdat_m1b, type="probability", level=0.80,
                        include.resid.var = F)
m1bv <- cbind(newdat_m1b, m1bv) %>%
  mutate(Period = "Post-Republican Revolution")

m1abv <- rbind(m1av, m1bv)


m1abv %>%
  mutate(partyid = factor(partyid),
         partyid = fct_recode(partyid,
                              "Strong\nDemocrat" = "0",
                              "Weak\nDemocrat" = "1",
                              "Ind., lean\nDemocrat" = "2",
                              "Independent" = "3",
                              "Ind., Lean\nRepublican" = "4",
                              "Weak\nRepublican" = "5",
                              "Strong\nRepublican" = "6")) %>%
  ggplot(., aes(x = partyid, y = fit, ymin = lwr, ymax=upr, group = Period, aes(color=Period))) +
  facet_wrap(~regioncondensed, 2) + theme_steve() +
  geom_ribbon(aes(fill = Period), alpha = I(0.2), color = I("black")) +
  geom_line(aes(color=Period, linetype = Period), size=1.5) +
  xlab("") + ylab("Simulated Probability of Support for Requiring\na Police Permit Before Obtaining a Gun") +
#    labs(caption="Source: General Social Survey (1972-2016)") +
   theme(legend.position='bottom') +
  labs(caption = "Data: General Social Survey (1974-2016)",
       title = "The Republican Revolution Made Strong Democrats in the South More Supportive of Gun Control",
       subtitle = "It also made Republicans in the Northest less supportive of gun control, but the effects are quite small.")
#  ggtitle("Support for Gun Control by Partisanship, Before and After the Republican Revolution")

```

Figure \ref{fig:simyearregion} generates simulations of the likelihood of supporting mandatory police permits before obtaining a gun by condensed Census region and three values of partisanship: strong Democrats, strong Republicans, and pure independents who say they do not lean either way. The results are consistent with the previous discussion that suggests even strong Republicans support gun control and that gun control's polarization on partisan lines is only recent. The South is unique among the four regions here because we cannot discern a difference between independents and the strong Republicans and strong Democrats in the more recent survey waves when we factor in the uncertainty around the simulation's estimates. The simulations for the three other regions in the most recent survey waves suggest differences among all three partisan groups with the widest differences among groups appearing in the West.

```{r simyearregion, echo=F, eval=T, fig.width=9, fig.cap="\\label{fig:simyearregion} Support for Gun Control by Partisanship and Region", fig.height =8}

m1rv %>%
  filter(partyid == 0 | partyid == 3 | partyid == 6) %>%
  mutate(partyid = factor(partyid),
         partyid = fct_recode(partyid,
                              "Strong Democrat" = "0",
                              "Independent" = "3",
                              "Strong Republican" = "6"),
         partyid = fct_relevel(partyid,
                               "Strong Republican","Independent","Strong Democrat" )) %>%
  rename(`Party ID` = partyid) %>%
  ggplot(.,aes(x=year, y=fit, ymin=lwr, ymax=upr, fill=`Party ID`)) +
  facet_wrap(~regioncondensed, 2) + theme_steve() +
  geom_line(aes(color=`Party ID`, linetype=`Party ID`), size = 1.2) +
  geom_ribbon(aes(fill = `Party ID`), alpha = I(0.2), color = I("black")) +
  scale_x_continuous(breaks=seq(1972, 2016, 4), name="Year", limits=c(1972, 2016)) + 
  geom_hline(yintercept = .5, linetype = "dashed") +
  ylab("Simulated Probability of Support for Requiring\na Police Permit Before Obtaining a Gun") +
  theme(legend.position='bottom') +
  labs(caption = "Data: General Social Survey (1974-2016)",
       title = "The Greatest Polarization on Gun Control is in the Midwest and Especially the West",
       subtitle = "We don't observe as much polarization on gun control in the Northeast or the South.")

```

All told, there is clear regional variation in attitudes toward gun control by different values of partisanship and over time. However, the variation does not fit a simple pattern we otherwise casually assume. Strong Democrats in the South---and not the region's strong Republicans, per se---observe a change in attitudes toward gun control after the Republican Revolution. Changes in attitudes toward gun control in the Northeast after that sorting of the electorate was more about changes among Republicans than Democrats. More recent waves have seen significant partisan sorting on attitudes toward gun control in every region, though less so in the South.

# Conclusion

This study examined Americans' attitudes toward gun control over 28 waves of the GSS data, resulting in four findings that question conventional wisdom about public opinion in the gun control debate. First, GOP partisanship does not robustly reduce support for gun control. Second, most "strong Republicans" actually support a subtly aggressive form of gun control. Third, polarization in the gun control debate as a function of partisanship is only recent and partial, with stark differences emerging mostly in the Obama Administration. Fourth, simple statements of regional variation on attitudes about gun control (i.e. about the South and the West) mask important and more interesting variation we observe with actual data.

The findings I report should clarify what we think to be true about why gun control legislation is a non-starter in Congress. Congress is more polarized now than it has ever been [e.g. @andrisetal2015rpsc], which might explain why a divided government, in which the legislature is controlled by Republicans, would fail to pass meaningful gun control legislation during the Obama Administration. It is convenient to think Americans are polarized as well, especially if partisans adopt elite-level cues [c.f. @zaller1992nomo]. My analysis suggests this is not true, which conforms well to general arguments that Americans are not nearly as polarized at the mass-level as they are at the elite-level [e.g. @hilltausanovitch2015dr]. No matter how polarized Congress is, and how much we assume Republicans care deeply about the Second Amendment to the U.S. Constitution, more than half of those identifying the most with the GOP support a subtly aggressive form of gun control that appears regularly in the GSS data.

It is important for sake of an honest conversation that discussion of the gun control debate be mindful of these basic facts about where Americans stand on this issue. Consider a recent *New York Times* article from @buisangerkatz2017hpgd, which attempted to map more than two dozen potential gun control policies on a two-dimensional space by reference to whether Americans support it and whether experts would say it is effective. The crux of the article focused on squaring mass-level preferences with expert-level opinion, but their article buried an interesting lede. Only one of the 29 policies they measured---requiring an individual to demonstrate a "need" for a gun---had less than 50% of support of Americans. Even then, support was 49% among the general public in their poll.

This true statement about the distribution of attitudes toward gun control in the data belie the worrying trends we are seeing emerge among citizens. Republican partisans are gradually adopting elite cues on the topic of gun control. Right now, legislative unwillingness to address meaningful gun control falls more on lawmakers in Washington for not translating the public's preferences into laws that serve the public's interest and laws that promote the public's welfare. However, the trends in the data suggest citizens themselves will become obstacles to meaningful gun control solutions the extent to which opposition to gun control may soon become a majoritarian position among Republican partisans.

There is one silver lining for gun control advocates amid these worrying trends, the mass shootings we observe, and that Republicans, as of 2017, control all chambers of government. The GSS gun control measure is peculiar both because we regularly observe it in almost all survey waves since 1972 and because almost no gun control discussion approaches the topic of linking gun acquisition to mandatory police permits. Whereas gun control opponents couch their opposition in the language of state overreach into civil liberties, gun control advocates instead prefer to massage objections from gun control opponents by proposing solutions that target gun show loopholes, terror watch lists, and military-style assault rifles. The GSS data suggest this might be a missed opportunity for gun control advocates to engage in deliberate issue-linkage. Citizens routinely list the police as one of the most trusted institutions in the country, behind only the military and small businesses [@gallup2017ci]. Gun control advocates may better advance their cause by linking police security with overall public security in advocating for gun control.

<!-- The failure to push common sense gun control into legislation may be a "moral outrage and national disgrace" as @nyt2015egea of the *New York Times* wrote on its front page after the San Bernardino terrorist incident. However, my analysis suggests that outrage and disgrace falls mostly on elected officials who are not channeling clear preferences among the general public, even among strong Republicans, into meaningful legislation. -->


\newpage


<!-- # References
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\vspace*{-0.2in}
\noindent
\singlespacing -->
